# update-url: https://raw.githubusercontent.com/justzerock/scripts/master/stash/profiles/ruleszerock-for-clash.yaml

mixed-port: 7890
allow-lan: true
mode: Rule
log-level: info
external-controller: 0.0.0.0:9090

dns:
  nameserver:
    - 223.5.5.5
    - 119.29.29.29
  fake-ip-filter:
    # from: https://github.com/Kr328/ClashForAndroid/blob/ffa559a57102ed8bc20eba41aa236a7764741bf9/core/src/main/golang/native/config/defaults.go#L10
    # Stun Services
    - "+.stun.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*.*"
    - "+.stun.*.*.*.*.*"
    # Google Voices
    - "lens.l.google.com"
    # Nintendo Switch
    - "*.n.n.srv.nintendo.net"
    # PlayStation
    - "+.stun.playstation.net"
    # XBox
    - "xbox.*.*.microsoft.com"
    - "*.*.xboxlive.com"
    # Microsoft
    - "*.msftncsi.com"
    - "*.msftconnecttest.com"
    # Bilibili CDN
    - "*.mcdn.bilivideo.cn"
http:
  url-rewrite:
    - ^https?:\/\/(www.)?(g|google)\.cn https://www.google.com 302

      
# å‡å¦‚ç”¨ç»„åˆè®¢é˜…å¤šä¸ªæœºåœºï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨ subscribe-url äº†
# subscribe-url: https://sub.store/download/collection/subs
# æ›¿æ¢ä¸Šé¢æ–‡å­—ç”¨äº Stash è·å–æœºåœºæµé‡ä¿¡æ¯å¹¶åœ¨ä¸»é¡µæ˜¾ç¤º ï¼ˆStash1.6.1 build 287+æ”¯æŒï¼‰

# è¿œç¨‹èµ„æºé»˜è®¤é…ç½®
remote-resources-default-config: &remote-resources-default-config
  type: http
  interval: 86400

proxy-providers:
  # å…¨éƒ¨èŠ‚ç‚¹
  all-sub: &all-sub # å»ºç«‹é”šç‚¹
    <<: *remote-resources-default-config
    # æ­¤å¤„é»˜è®¤ä½¿ç”¨ Sub-Store è®¢é˜…é“¾æ¥ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å…¶ä»–è®¢é˜…é“¾æ¥ï¼Œå¯ä»¥æ›¿æ¢ä¸‹é¢çš„ url å³å¯
    # Sub-Store ä¸ Clash ç±»å‹è®¢é˜…é“¾æ¥ï¼Œéƒ½å¯ä»¥ä½œä¸º url çš„å€¼ã€‚å¤šä¸ªé“¾æ¥ä½¿ç”¨è‹±æ–‡ç¬¦å·çš„ç«–æ  | éš”å¼€ä¸€èµ·å†™ä¸Šå³å¯
    url: # æˆ‘æ˜¯è®¢é˜…é“¾æ¥
    path: ./all.yaml
    health-check:
      enable: true
      interval: 600
      url: https://captive.apple.com

rule-providers:
  direct:
    <<: *remote-resources-default-config
    behavior: domain
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt
    path: ./ruleset/direct.yaml
  proxy:
    <<: *remote-resources-default-config
    behavior: domain
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt
    path: ./ruleset/proxy.yaml
  reject:
    <<: *remote-resources-default-config
    behavior: domain
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt
    path: ./ruleset/reject.yaml
  private:
    <<: *remote-resources-default-config
    behavior: domain
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt
    path: ./ruleset/private.yaml
  apple:
    <<: *remote-resources-default-config
    behavior: domain
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt
    path: ./ruleset/apple.yaml
  icloud:
    <<: *remote-resources-default-config
    behavior: domain
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt
    path: ./ruleset/icloud.yaml
  telegramcidr:
    <<: *remote-resources-default-config
    behavior: ipcidr
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt
    path: ./ruleset/telegramcidr.yaml
  cncidr:
    <<: *remote-resources-default-config
    behavior: ipcidr
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt
    path: ./ruleset/cncidr.yaml
  lancidr:
    <<: *remote-resources-default-config
    behavior: ipcidr
    interval: 86400
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt
    path: ./ruleset/lancidr.yaml
  zerock:
    <<: *remote-resources-default-config
    behavior: domain
    interval: 86400
    url: https://cdn.staticaly.com/gh/justzerock/scripts/master/stash/rules/direct-domain.txt
    path: ./ruleset/zerock.yaml

proxy-groups:
  - name: å»¶è¿Ÿæœ€ä½
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub

  - name: æ‰‹åŠ¨é€‰æ‹©
    type: select
    proxies:
      - å»¶è¿Ÿæœ€ä½
      - ğŸ‡ºğŸ‡¸ ç¾å›½
      - ğŸ‡­ğŸ‡° é¦™æ¸¯
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬
      - ğŸ‡¬ğŸ‡§ è‹±å›½
      - GlaDOS
      - ä¸€å…ƒæœºåœº
      - PUREFAST
      - IKUUU VPN
      - FreeFQ
      - DIRECT
    use:
      - all-sub

  - name: å…¨çƒç›´è¿
    type: select
    proxies: &global-direct
      - DIRECT
      - æ‰‹åŠ¨é€‰æ‹©

  - name: è‡ªç”¨ç›´è¿
    type: select
    proxies:
      *global-direct

  - name: è‹¹æœæœåŠ¡
    type: select
    proxies:
      *global-direct

  - name: å¹¿å‘Šæ‹¦æˆª
    type: select
    proxies:
      - REJECT
      - DIRECT

  - name: å…¨çƒä»£ç†
    type: select
    proxies: &global-proxy
      - æ‰‹åŠ¨é€‰æ‹©
      - DIRECT

  - name: ç”µæŠ¥ä¿¡æ¯
    type: select
    proxies:
      *global-proxy

  - name: æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - æ‰‹åŠ¨é€‰æ‹©
      - DIRECT

  - name: ğŸ‡ºğŸ‡¸ ç¾å›½
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "ç¾å›½|ğŸ‡ºğŸ‡²|US"

  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "é¦™æ¸¯|ğŸ‡­ğŸ‡°|HK"

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "æ—¥æœ¬|ğŸ‡¯ğŸ‡µ|JP"

  - name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "æ–°åŠ å¡|ğŸ‡¸ğŸ‡¬|SG"

  - name: ğŸ‡¬ğŸ‡§ è‹±å›½
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "è‹±å›½|ğŸ‡¬ğŸ‡§|UK"

  - name: GlaDOS
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "(?i)glados"

  - name: ä¸€å…ƒæœºåœº
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "ä¸€å…ƒ"

  - name: PUREFAST
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "purefast"

  - name: IKUUU VPN
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "iku"

  - name: FreeFQ
    type: url-test
    url: https://captive.apple.com
    interval: 300
    use:
      - all-sub
    filter: "free"


rules:
  - RULE-SET,zerock,è‡ªç”¨ç›´è¿
  - RULE-SET,direct,å…¨çƒç›´è¿
  - RULE-SET,proxy,å…¨çƒä»£ç†
  - RULE-SET,reject,å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,private,å…¨çƒç›´è¿
  - RULE-SET,apple,è‹¹æœæœåŠ¡
  - RULE-SET,icloud,è‹¹æœæœåŠ¡
  - RULE-SET,telegramcidr,ç”µæŠ¥ä¿¡æ¯
  - RULE-SET,cncidr,å…¨çƒç›´è¿
  - RULE-SET,lancidr,å…¨çƒç›´è¿
  - GEOIP,CN,DIRECT
  - MATCH,æ¼ç½‘ä¹‹é±¼